function manualLogin() {
    if (isInTeams) {
        microsoftTeams.initialize();
        microsoftTeams.authentication.authenticate({
            url: window.location.origin + "/auth-start.html",
            width: 600,
            height: 535,
            successCallback: async (accessToken) => {
                try {
                    // Store the access token or use it directly
                    document.getElementById('userInfo').textContent = "Login successful.";
                    document.getElementById('loginBtn').style.display = 'none';
                    document.getElementById('logoutBtn').style.display = 'inline-block';
                    showNotification('Login successful!', 'success');
                    // Optionally, store the token or refresh MSAL account
                    const accounts = msalInstance.getAllAccounts();
                    if (accounts.length > 0) {
                        document.getElementById('userInfo').textContent = `Logged in as ${accounts[0].username}`;
                    }
                } catch (error) {
                    showNotification(`Error processing login: ${error.message}`, 'error');
                }
            },
            failureCallback: (error) => {
                showNotification(`Login failed: ${error}`, 'error');
            }
        });
    } else {
        msalInstance.loginPopup({ scopes: appConfig.scopes }).then(response => {
            document.getElementById('userInfo').textContent = `Logged in as ${response.account.username}`;
            document.getElementById('loginBtn').style.display = 'none';
            document.getElementById('logoutBtn').style.display = 'inline-block';
            showNotification('Login successful!', 'success');
        }).catch(error => {
            showNotification(`Login failed: ${error.message}`, 'error');
        });
    }
}
